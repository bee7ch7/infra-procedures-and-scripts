1. Generate certificates on the users machine
```
openssl genrsa -out myuser.key 2048
openssl req -new -key myuser.key -subj "/CN=myuser" -out myuser.csr
cat myuser.csr | base64 -w 0
LS0tLS1CRUdJTiBDRVJUSUZJQ0FURSBSRVFVRVNULS0tLS0KTUlJQ1ZqQ0NBVDRDQVFBd0VURVBNQTBHQTFVRUF3d0diWGwxYzJWeU1JSUJJakFOQmdrcWhraUc5dzBCQVFFRgpBQU9DQVE4QU1JSUJDZ0tDQVFFQWxHVzFiWVFYUWVOU2lpVExEZWhWOXhkdjBvRlhTdGFCL3FibU1TVjhqeDRxCitGcFpRNEovM3B0anRTZTg3SHhpUDdWQXdtazVwSFpvOUFmSXlxZVRBdUlWUXhGTE9hMkhFeC9uQ09oMGFpcGUKOHIxZTNQTnc1YVhrZnBkQ05qVlMwalR1K3NVelZMcm1GMC81a2YyM256NkJ1YmNRMlJCV04xVHJWQWpSRnBOZApVWUNndElyZmE5d25tUG9LZlVSTlVMSGZ4OFNXd0VsS2pzUXJnRUo5MGp4aHNXdFR2M1BMVGo3TmlQeE5vbW1yCkE1SFRZL1ZDNVBENDUzcFVjNnBGNjhEcUMxL21ORTJqMkZMeGRwZUZOQjNIQkdCY253S0RFNnpYR0JwVXpGTWcKTFdPRDJIdHRwamR4YVNDZE12Wjh5WW5ZeExOaTJjY1FmcEZLT0VTQmpRSURBUUFCb0FBd0RRWUpLb1pJaHZjTgpBUUVMQlFBRGdnRUJBQ2UyUWUycmR5VGZFT3A2RFFtTHZJUTZjNndFY3dVNE14RmkweTAyR01RTXdhS3llWUpaCkNVQXV5UTJWYSsxdXhzemF5ZWF5MExYTURNbmJZNG9KSmk0bjlNeHdPMGIwLzgwRDAvTHRmczM3ZkZ0bk95T28Kb0xDVnFTTDZnSEFYeENNamdCV1VsVVo3L1NNNHBtc1M2eGN1MFBJbnR5a3VndWlGS283QjBhY2Z5SWNtcG5IcApCSWhPRzM0bDdLbE14b2hsaGVZdWQ1V1RkSVdLS084dUJRV29KRFBIMm9tdHJ4U0hPVVpqR1FRT2hScVdudFpGCitoczZySmVTcko5ZGQzeHI3VG1TV3cwRURQSG04KzhFL2kvdE02Rk9zb0dwRVpmM2pJd0d0WXRoM3JFOVhJd2UKTVJlMXQ4L200dHVHZkc3VWc0ck5sOW5rWnlmVnhUdENZNVU9Ci0tLS0tRU5EIENFUlRJRklDQVRFIFJFUVVFU1QtLS0tLQo=
```
2. Create signing request in Kubernetes cluster with the output of command above: ```cat myuser.csr | base64 -w 0```
```
cat <<EOF | kubectl apply -f -
apiVersion: certificates.k8s.io/v1
kind: CertificateSigningRequest
metadata:
  name: myuser
spec:
  request: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURSBSRVFVRVNULS0tLS0KTUlJQ1ZqQ0NBVDRDQVFBd0VURVBNQTBHQTFVRUF3d0diWGwxYzJWeU1JSUJJakFOQmdrcWhraUc5dzBCQVFFRgpBQU9DQVE4QU1JSUJDZ0tDQVFFQWxHVzFiWVFYUWVOU2lpVExEZWhWOXhkdjBvRlhTdGFCL3FibU1TVjhqeDRxCitGcFpRNEovM3B0anRTZTg3SHhpUDdWQXdtazVwSFpvOUFmSXlxZVRBdUlWUXhGTE9hMkhFeC9uQ09oMGFpcGUKOHIxZTNQTnc1YVhrZnBkQ05qVlMwalR1K3NVelZMcm1GMC81a2YyM256NkJ1YmNRMlJCV04xVHJWQWpSRnBOZApVWUNndElyZmE5d25tUG9LZlVSTlVMSGZ4OFNXd0VsS2pzUXJnRUo5MGp4aHNXdFR2M1BMVGo3TmlQeE5vbW1yCkE1SFRZL1ZDNVBENDUzcFVjNnBGNjhEcUMxL21ORTJqMkZMeGRwZUZOQjNIQkdCY253S0RFNnpYR0JwVXpGTWcKTFdPRDJIdHRwamR4YVNDZE12Wjh5WW5ZeExOaTJjY1FmcEZLT0VTQmpRSURBUUFCb0FBd0RRWUpLb1pJaHZjTgpBUUVMQlFBRGdnRUJBQ2UyUWUycmR5VGZFT3A2RFFtTHZJUTZjNndFY3dVNE14RmkweTAyR01RTXdhS3llWUpaCkNVQXV5UTJWYSsxdXhzemF5ZWF5MExYTURNbmJZNG9KSmk0bjlNeHdPMGIwLzgwRDAvTHRmczM3ZkZ0bk95T28Kb0xDVnFTTDZnSEFYeENNamdCV1VsVVo3L1NNNHBtc1M2eGN1MFBJbnR5a3VndWlGS283QjBhY2Z5SWNtcG5IcApCSWhPRzM0bDdLbE14b2hsaGVZdWQ1V1RkSVdLS084dUJRV29KRFBIMm9tdHJ4U0hPVVpqR1FRT2hScVdudFpGCitoczZySmVTcko5ZGQzeHI3VG1TV3cwRURQSG04KzhFL2kvdE02Rk9zb0dwRVpmM2pJd0d0WXRoM3JFOVhJd2UKTVJlMXQ4L200dHVHZkc3VWc0ck5sOW5rWnlmVnhUdENZNVU9Ci0tLS0tRU5EIENFUlRJRklDQVRFIFJFUVVFU1QtLS0tLQo=
  signerName: kubernetes.io/kube-apiserver-client
  usages:
  - client auth
EOF
```
3. Approve CSR and share signed certificate with the user
```
kubectl certificate approve myuser
kubectl get csr myuser -o jsonpath='{.status.certificate}'| base64 -d > myuser.crt
```

4. Create role and role-binding (clusterrole and clusterrolebinding)
```
kubectl create role developer --verb='*' --resource='*'
kubectl create rolebinding developer-binding-myuser --role=developer --user=myuser
```
5. On the user machine:
```
kubectl config set-credentials myuser --client-key=myuser.key --client-certificate=myuser.crt --embed-certs=true
kubectl config set-context myuser --cluster=minikube --user=myuser
kubectl config use-context myuser
```
